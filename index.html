<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSGE AI Shock Analysis - Interactive Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }

        .control-value {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            border: none;
        }

        .range-labels {
            display: flex;
            justify-content: space-between;
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 30px;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #1976d2;
            margin-bottom: 8px;
        }

        .info-box p {
            color: #555;
            line-height: 1.6;
        }

        .charts {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 30px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: 700;
            color: #667eea;
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 2px solid #e9ecef;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ DSGE AI Shock Analysis</h1>
            <p>Interactive Economic Model Dashboard</p>
            <p style="font-size: 0.9em; margin-top: 10px;">By Ali Anver | DGSE for Keep the Future Human</p>
        </div>

        <div class="info-box">
            <h3>About This Model</h3>
            <p>
                This interactive dashboard shows how changes in <strong>technology shock parameters</strong> 
                and <strong>capital share</strong> affect economic outcomes in a Dynamic Stochastic General 
                Equilibrium (DSGE) model. Adjust the sliders to see how different AI productivity scenarios 
                impact GDP, consumption, investment, and wages.
            </p>
        </div>

        <div class="controls">
            <div class="control-group">
                <div class="control-label">
                    <span>üìà Technology Persistence (œÅ_z)</span>
                    <span class="control-value" id="rho-value">0.95</span>
                </div>
                <input type="range" id="rho-slider" min="0" max="4" step="1" value="2">
                <div class="range-labels">
                    <span>0.90 (Low)</span>
                    <span>0.95 (Baseline)</span>
                    <span>0.98 (AI Era)</span>
                </div>
            </div>

            <div class="control-group">
                <div class="control-label">
                    <span>üí• Technology Volatility (œÉ_z)</span>
                    <span class="control-value" id="sigma-value">0.007</span>
                </div>
                <input type="range" id="sigma-slider" min="0" max="4" step="1" value="1">
                <div class="range-labels">
                    <span>0.005 (Small)</span>
                    <span>0.010 (Moderate)</span>
                    <span>0.020 (Large AI Shock)</span>
                </div>
            </div>

            <div class="control-group">
                <div class="control-label">
                    <span>‚öñÔ∏è Capital Share (Œ±)</span>
                    <span class="control-value" id="alpha-value">0.36</span>
                </div>
                <input type="range" id="alpha-slider" min="0" max="4" step="1" value="2">
                <div class="range-labels">
                    <span>0.30 (Labor-intensive)</span>
                    <span>0.36 (Baseline)</span>
                    <span>0.45 (Capital-intensive)</span>
                </div>
            </div>
        </div>

        <div class="stats-grid" id="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Average GDP</div>
                <div class="stat-value" id="stat-gdp">--</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Final GDP</div>
                <div class="stat-value" id="stat-final-gdp">--</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Average Wages</div>
                <div class="stat-value" id="stat-wages">--</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Capital Return</div>
                <div class="stat-value" id="stat-return">--</div>
            </div>
        </div>

        <div class="charts">
            <div class="chart-container">
                <div class="chart-title">üìä Output (GDP) Over Time</div>
                <div id="output-chart"></div>
            </div>

            <div class="chart-container">
                <div class="chart-title">üí∞ Consumption & Investment</div>
                <div id="ci-chart"></div>
            </div>

            <div class="chart-container">
                <div class="chart-title">üíº Wages & Capital Returns</div>
                <div id="wage-chart"></div>
            </div>

            <div class="chart-container">
                <div class="chart-title">‚öôÔ∏è Technology Level (Productivity)</div>
                <div id="tech-chart"></div>
            </div>
        </div>

        <div class="footer">
            <p><strong>DSGE AI Shock Analysis Dashboard</strong></p>
            <p>Data generated from calibrated DSGE model simulations</p>
            <p style="margin-top: 10px; font-size: 0.9em;">
                Model parameters: Œ≤ = 0.96, Œ¥ = 0.025 | Simulation: 100 periods with AI shock at period 25
            </p>
        </div>
    </div>

    <script>
        // Parameter value arrays
        const RHO_VALUES = [0.90, 0.93, 0.95, 0.97, 0.98];
        const SIGMA_VALUES = [0.005, 0.007, 0.010, 0.015, 0.020];
        const ALPHA_VALUES = [0.30, 0.33, 0.36, 0.40, 0.45];

        let simulationData = null;

        // Load simulation data
        async function loadData() {
            try {
                const response = await fetch('simulation_results/simulation_data.json');
                simulationData = await response.json();
                console.log('Loaded', simulationData.simulations.length, 'simulations');
                updateVisualization();
            } catch (error) {
                console.error('Error loading data:', error);
                alert('Error loading simulation data. Please run the Julia simulation first.');
            }
        }

        // Find closest simulation
        function findSimulation(alpha, rho, sigma) {
            if (!simulationData) return null;
            
            return simulationData.simulations.find(sim => 
                sim.Œ± === alpha && sim.œÅ_z === rho && sim.œÉ_z === sigma
            );
        }

        // Update visualization
        function updateVisualization() {
            const alphaIdx = parseInt(document.getElementById('alpha-slider').value);
            const rhoIdx = parseInt(document.getElementById('rho-slider').value);
            const sigmaIdx = parseInt(document.getElementById('sigma-slider').value);

            const alpha = ALPHA_VALUES[alphaIdx];
            const rho = RHO_VALUES[rhoIdx];
            const sigma = SIGMA_VALUES[sigmaIdx];

            // Update displays
            document.getElementById('alpha-value').textContent = alpha.toFixed(2);
            document.getElementById('rho-value').textContent = rho.toFixed(2);
            document.getElementById('sigma-value').textContent = sigma.toFixed(3);

            // Find simulation
            const sim = findSimulation(alpha, rho, sigma);
            if (!sim) {
                console.error('Simulation not found for:', { alpha, rho, sigma });
                return;
            }

            // Update stats
            document.getElementById('stat-gdp').textContent = sim.summary.avg_output.toFixed(4);
            document.getElementById('stat-final-gdp').textContent = sim.summary.final_output.toFixed(4);
            document.getElementById('stat-wages').textContent = sim.summary.avg_wages.toFixed(4);
            document.getElementById('stat-return').textContent = sim.summary.avg_capital_return.toFixed(4);

            // Plot charts
            plotOutputChart(sim.data);
            plotCIChart(sim.data);
            plotWageChart(sim.data);
            plotTechChart(sim.data);
        }

        function plotOutputChart(data) {
            const trace = {
                x: data.periods,
                y: data.output,
                type: 'scatter',
                mode: 'lines',
                line: { color: '#667eea', width: 3 },
                fill: 'tozeroy',
                fillcolor: 'rgba(102, 126, 234, 0.2)',
                name: 'GDP'
            };

            // Mark AI shock period
            const shapes = [{
                type: 'line',
                x0: 25,
                x1: 25,
                y0: 0,
                y1: Math.max(...data.output),
                line: { color: 'red', width: 2, dash: 'dash' }
            }];

            const annotations = [{
                x: 25,
                y: Math.max(...data.output),
                text: 'AI Shock',
                showarrow: true,
                arrowhead: 2,
                ax: 40,
                ay: -40,
                font: { color: 'red' }
            }];

            const layout = {
                xaxis: { title: 'Period' },
                yaxis: { title: 'Output (GDP)' },
                shapes: shapes,
                annotations: annotations,
                showlegend: false,
                margin: { t: 20, r: 20, b: 50, l: 60 }
            };

            Plotly.newPlot('output-chart', [trace], layout, {responsive: true});
        }

        function plotCIChart(data) {
            const trace1 = {
                x: data.periods,
                y: data.consumption,
                type: 'scatter',
                mode: 'lines',
                name: 'Consumption',
                line: { color: '#4CAF50', width: 2 }
            };

            const trace2 = {
                x: data.periods,
                y: data.investment,
                type: 'scatter',
                mode: 'lines',
                name: 'Investment',
                line: { color: '#FF9800', width: 2 }
            };

            const layout = {
                xaxis: { title: 'Period' },
                yaxis: { title: 'Value' },
                showlegend: true,
                legend: { x: 0.7, y: 1 },
                margin: { t: 20, r: 20, b: 50, l: 60 }
            };

            Plotly.newPlot('ci-chart', [trace1, trace2], layout, {responsive: true});
        }

        function plotWageChart(data) {
            const trace1 = {
                x: data.periods,
                y: data.wages,
                type: 'scatter',
                mode: 'lines',
                name: 'Wages',
                line: { color: '#2196F3', width: 2 }
            };

            const trace2 = {
                x: data.periods,
                y: data.capital_return,
                type: 'scatter',
                mode: 'lines',
                name: 'Capital Return',
                line: { color: '#9C27B0', width: 2 },
                yaxis: 'y2'
            };

            const layout = {
                xaxis: { title: 'Period' },
                yaxis: { title: 'Wages' },
                yaxis2: {
                    title: 'Capital Return',
                    overlaying: 'y',
                    side: 'right'
                },
                showlegend: true,
                legend: { x: 0.7, y: 1 },
                margin: { t: 20, r: 60, b: 50, l: 60 }
            };

            Plotly.newPlot('wage-chart', [trace1, trace2], layout, {responsive: true});
        }

        function plotTechChart(data) {
            const trace = {
                x: data.periods,
                y: data.technology,
                type: 'scatter',
                mode: 'lines',
                line: { color: '#E91E63', width: 3 },
                name: 'Technology'
            };

            const layout = {
                xaxis: { title: 'Period' },
                yaxis: { title: 'Technology Level (A)' },
                showlegend: false,
                margin: { t: 20, r: 20, b: 50, l: 60 }
            };

            Plotly.newPlot('tech-chart', [trace], layout, {responsive: true});
        }

        // Event listeners
        document.getElementById('alpha-slider').addEventListener('input', updateVisualization);
        document.getElementById('rho-slider').addEventListener('input', updateVisualization);
        document.getElementById('sigma-slider').addEventListener('input', updateVisualization);

        // Load data on page load
        loadData();
    </script>
</body>
</html>
